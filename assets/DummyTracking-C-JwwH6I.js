import{k as D,r as u,l as b,o as k,j as e,d as C,b as g,B as O,L as p,I as T,J as E,K as y,M as S,N as R}from"./index-BJY4bUza.js";const Y=()=>{const{trackingNumber:f}=D(),[t,x]=u.useState(null),[j,v]=u.useState(!0),c=[{name:"Order Received",icon:e.jsx(T,{})},{name:"Packed",icon:e.jsx(E,{})},{name:"Picked Up",icon:e.jsx(y,{})},{name:"In Transit",icon:e.jsx(S,{})},{name:"Out for Delivery",icon:e.jsx(y,{})},{name:"Delivered",icon:e.jsx(R,{})}],m={"Order Received":"Your order has been placed successfully.",Packed:"Your order is packed and ready for shipment.","Picked Up":"Courier has picked up your package.","In Transit":"Your package is on its way.","Out for Delivery":"Courier is out for delivery.",Delivered:"Your package has been delivered.",Cancelled:"This order has been cancelled."};if(u.useEffect(()=>{const s=b(g,"users"),r=k(s,n=>{let d=!1;const a=[];return n.forEach(o=>{const _=b(g,"users",o.id,"orders"),I=k(_,w=>{w.forEach(h=>{const i=h.data();i.tracking_number===f&&(x({orderId:h.id,userId:o.id,tracking_number:i.tracking_number,status:i.status,tracking_status:i.tracking_status||"Order Received",estimatedDelivery:i.estimatedDelivery||"3-5 business days"}),d=!0)}),d||x(null),v(!1)});a.push(I)}),()=>a.forEach(o=>o())});return()=>r()},[f]),u.useEffect(()=>{if(!t||t.tracking_status==="Delivered"||t.tracking_status==="Cancelled")return;const s=setInterval(async()=>{const r=c.findIndex(a=>a.name===t.tracking_status),n=c[r+1]?.name;if(!n){clearInterval(s);return}const d=C(g,"users",t.userId,"orders",t.orderId);await O(d,{tracking_status:n}),x(a=>({...a,tracking_status:n}))},15e3);return()=>clearInterval(s)},[t]),j)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-gray-800 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading tracking info..."})]});if(!t)return e.jsxs("div",{className:"p-6 text-center text-gray-500 bg-gray-50 min-h-screen flex flex-col justify-center",children:["Tracking info not found",e.jsx(p,{to:"/orderhistory",className:"mt-4 text-blue-600 underline",children:"Back to Orders"})]});const l=t.tracking_status==="Cancelled"?-1:c.findIndex(s=>s.name===t.tracking_status),N=s=>t.tracking_status==="Cancelled"?"bg-red-500 text-white":s<l?"bg-green-500 text-white":s===l?"bg-blue-500 text-white":"bg-gray-200 text-gray-700";return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center p-4",children:[e.jsx("div",{className:"w-full max-w-xl flex justify-between items-center mb-6",children:e.jsx(p,{to:"/orderhistory",className:"text-blue-600 underline hover:text-blue-800",children:"Back to Orders"})}),e.jsxs("div",{className:"p-6 max-w-xl bg-white shadow rounded w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"ðŸ“¦ Track Your Order"}),e.jsxs("p",{className:"text-sm text-gray-600 text-center mb-2",children:["Tracking Number: ",e.jsx("strong",{children:t.tracking_number})]}),e.jsxs("p",{className:"text-lg font-semibold text-center mb-4",children:["Status:"," ",e.jsx("span",{className:t.tracking_status==="Cancelled"?"text-red-600":t.tracking_status==="Delivered"?"text-green-600":"text-blue-500",children:t.tracking_status})]}),e.jsxs("p",{className:"text-gray-500 text-sm text-center mb-6",children:["Estimated Delivery: ",e.jsx("strong",{children:t.estimatedDelivery})]}),e.jsx("div",{className:"relative flex flex-col items-start gap-6 pl-8",children:c.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-4 relative",children:[r!==0&&e.jsx("span",{className:`absolute left-4 top-0 h-full w-0.5 ${r<=l?"bg-green-500":"bg-gray-300"}`}),e.jsx("div",{className:`p-3 rounded-full flex items-center justify-center ${N(r)}`,style:{minWidth:"40px",minHeight:"40px",zIndex:10},children:s.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name}),r===l&&e.jsx("p",{className:"text-sm text-gray-600",children:m[s.name]})]})]},s.name))}),e.jsx("p",{className:"mt-4 text-center text-gray-600",children:t.tracking_status==="Cancelled"?m.Cancelled:t.tracking_status==="Delivered"?m.Delivered:"Your package is on its way and updates automatically."})]})]})};export{Y as default};
